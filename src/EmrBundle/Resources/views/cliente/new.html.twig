{% extends "Layout/base_emr/_clients_base.location.html.twig" %}

{% block title_page %}
    Sitema Medico EMR || Regístrate
{% endblock %}

{#
{% block breadcrumb %}
    {{ include('EmrBundle:Dashboard:_breadcrumb.html.twig' )  }}
{% endblock %} 

{% block submenutop %}
    {{ include('EmrBundle:Dashboard:_submenu.html.twig' )  }}
{% endblock %} 
#}

{% block body %}    
    <div class="page-header-content">
        <div class="page-title">
            <h4>
                <i class="icon-arrow-left52 position-left"></i>
                <span class="text-semibold">Website</span> - Regístro de nuevo cliente

                <small class="display-block">Formulario para nuevo cliente!</small></h4>
            <a class="heading-elements-toggle"><i class="icon-more"></i></a></div>

        <div class="heading-elements">
            <div class="heading-btn-group">
                <a href="#" class="btn btn-link btn-float has-text"><i class="icon-bars-alt text-primary"></i><span>Statistics</span></a>
                <a href="#" class="btn btn-link btn-float has-text"><i class="icon-calculator text-primary"></i> <span>Invoices</span></a>
                <a href="#" class="btn btn-link btn-float has-text"><i class="icon-calendar5 text-primary"></i> <span>Schedule</span></a>
            </div>
        </div>
    </div>
    
    
    <div class="row">
        <div class="col-lg-12">

            <!-- Check the notifications -->
            {% for message in app.session.flashbag().get("success") %}
                <div class="alert alert-success"><i class="fa fa-check-circle"></i> {{message}}</div>
            {% endfor %}
            {% for message in app.session.flashbag().get("error") %}
                <div class="alert alert-danger"><i class="fa fa-close"></i> {{message}}</div>
            {% endfor %}
            <!-- End notifications -->
        </div>
    </div>
            
    <div class="panel border-left-lg border-left-success">
        <div class="panel-heading">
            <h6 class="panel-title"><i class="fa fa-hospital-o"></i> Datos del establecimiento</h6>
            <div class="heading-elements">
                <ul class="icons-list">
                    <li><a data-action="collapse"></a></li>
                    <li><a data-action="reload"></a></li>
                    <li><a data-action="close"></a></li>
                </ul>
            </div>
        </div>
        <div class="panel-body">
            
            <div class="row">
            <div class="col-lg-6">        
            {#
            {{ form_start(form) }}
                {{ form_widget(form) }}
                <input type="submit" value="Create" />
            {{ form_end(form) }}
            #}
            {{ form_start(form, {'attr': {'class': 'steps-basic steps-validation'}}) }}
                <div class="form_error">{{ form_errors(form)}}</div>
                <h6>Establecimiento</h6>
                <fieldset title="1">
						<!--<legend class="text-semibold">Establecimiento</legend>-->
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliTipCli)}}</div>
                                    <label for="" class=" control-label">Tipo:</label>
                                    <div class="">{{ form_widget(form.cliTipCli,  { 'attr': {'class': 'select'} } ) }}</div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliNombreFiscal)}}</div>
                                    <label for="" class=" control-label">Nombre Fiscal:</label>
                                    <div class="">{{ form_widget(form.cliNombreFiscal) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                </div>
                            </div>    
                        </div>
                        <div class="row">
                            <div class="col-md-4">    
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliMun)}}</div>
                                    <label for="" class=" control-label">Municipio:</label>
                                    <div class="">{{ form_widget(form.cliMun) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                </div>
                            </div>    
                            <div class="col-md-8">
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliDireccion)}}</div>
                                    <label for="" class=" control-label">Dirección:</label>
                                    <div class="">{{ form_widget(form.cliDireccion) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                </div>
                            </div>
                        </div>        
                        <div class="row">
                            <div class="col-md-4">    
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliNit)}}</div>
                                    <label for="" class=" control-label">Nit:</label>
                                    <div class="">{{ form_widget(form.cliNit) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliTelefono1)}}</div>
                                    <label for="" class=" control-label">Teléfono 1:</label>
                                    <div class="">{{ form_widget(form.cliTelefono1) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliTelefono2)}}</div>
                                    <label for="" class=" control-label">Teléfono 2:</label>
                                    <div class="">{{ form_widget(form.cliTelefono2) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                </div>
                            </div>    
                        </div>      
                        <div class="row">
                            <div class="col-md-12">    
                                <div class="form-group">
                                    <div class="form_error">{{ form_errors(form.cliEsp)}}</div>
                                    <label for="" class=" control-label">Tipos de especialidades:</label>
                                    <div class="">{{ form_widget(form.cliEsp) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                </div>
                            </div>    
                        </div>
                </fieldset>
                                
                <h6>Representantes</h6>
                <fieldset title="2">
						<!-- <legend class="text-semibold">Representantes</legend> -->
                            
                            
							<div class="row">
                                {#
								<div class="col-md-6">
									<div class="form-group">
										<label>Nombre del representante: <span class="text-danger">*</span></label>
		                                <input type="text" name="nombre_representante" placeholder="Nombre del representante" class="form-control required">
	                                </div>
								</div>
                                #}
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <div class="form_error">{{ form_errors(form.cliNombre)}}</div>
                                        <label for="" class=" control-label">Nombre Representante: <span class="text-danger">*</span></label>
                                        <div class="">{{ form_widget(form.cliNombre) }}{# {{ form_widget(form.catalogName,  { 'attr': {'class': 'c4'} } ) }} #}</div>
                                    </div>
                                </div>

								<div class="col-md-6">
									<div class="form-group">
										<label>Genero:</label>
	                                    <select name="university-country" data-placeholder="Genero..." class="select">
	                                        <option></option> 
	                                        <option value="m">Masculino</option> 
	                                        <option value="f">Femenino</option> 
	                                    </select>
                                    </div>
								</div>
							</div>

							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label>Usuario: <span class="text-danger">*</span></label>
		                                <input type="text" name="degree-level" placeholder="Usuario" class="form-control required">
	                                </div>

									<div class="form-group">
										<label>Password: <span class="text-danger">*</span></label>
		                                <input type="password" name="password" placeholder="Password" class="form-control required">
	                                </div>
								</div>

								<div class="col-md-6">
									<div class="row">
										<div class="col-md-12">
											<label>Fecha nacimiento:</label>
											<div class="row">
												<div class="col-md-4">
													<div class="form-group">
					                                    <select name="education-from-month" data-placeholder="Month" class="select">
					                                    	<option></option>
					                                        <option value="January">January</option> 
					                                        <option value="...">...</option> 
					                                        <option value="December">December</option> 
					                                    </select>
				                                    </div>
												</div>

												<div class="col-md-4">
													<div class="form-group">
					                                    <select name="education-from-year" data-placeholder="Year" class="select">
					                                        <option></option> 
					                                        <option value="1995">1995</option> 
					                                        <option value="...">...</option> 
					                                        <option value="1980">1980</option> 
					                                    </select>
				                                    </div>
												</div>
                                                <div class="col-md-4">
													<div class="form-group">
					                                    <select name="education-from-year" data-placeholder="Year" class="select">
					                                        <option></option> 
					                                        <option value="1995">1995</option> 
					                                        <option value="...">...</option> 
					                                        <option value="1980">1980</option> 
					                                    </select>
				                                    </div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
				</fieldset>
                
                <h6>Drs/Asistentes</h6>
                <fieldset title="3">
							<!--<legend class="text-semibold"></legend>-->

							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label>Nombre del representante: <span class="text-danger">*</span></label>
		                                <input type="text" name="nombre_representante" placeholder="Nombre del representante" class="form-control required">
	                                </div>
								</div>

								<div class="col-md-6">
									<div class="form-group">
										<label>Genero:</label>
	                                    <select name="university-country" data-placeholder="Genero..." class="select">
	                                        <option></option> 
	                                        <option value="m">Masculino</option> 
	                                        <option value="f">Femenino</option> 
	                                    </select>
                                    </div>
								</div>
							</div>

							<div class="row">
								<div class="col-md-6">
									<div class="form-group">
										<label>Usuario: <span class="text-danger">*</span></label>
		                                <input type="text" name="degree-level" placeholder="Usuario" class="form-control required">
	                                </div>

									<div class="form-group">
										<label>Password: <span class="text-danger">*</span></label>
		                                <input type="password" name="password" placeholder="Password" class="form-control required">
	                                </div>
								</div>

								<div class="col-md-6">
									<div class="row">
										<div class="col-md-12">
											<label>Fecha nacimiento:</label>
											<div class="row">
												<div class="col-md-4">
													<div class="form-group">
					                                    <select name="education-from-month" data-placeholder="Month" class="select">
					                                    	<option></option>
					                                        <option value="January">January</option> 
					                                        <option value="...">...</option> 
					                                        <option value="December">December</option> 
					                                    </select>
				                                    </div>
												</div>

												<div class="col-md-4">
													<div class="form-group">
					                                    <select name="education-from-year" data-placeholder="Year" class="select">
					                                        <option></option> 
					                                        <option value="1995">1995</option> 
					                                        <option value="...">...</option> 
					                                        <option value="1980">1980</option> 
					                                    </select>
				                                    </div>
												</div>
                                                <div class="col-md-4">
													<div class="form-group">
					                                    <select name="education-from-year" data-placeholder="Year" class="select">
					                                        <option></option> 
					                                        <option value="1995">1995</option> 
					                                        <option value="...">...</option> 
					                                        <option value="1980">1980</option> 
					                                    </select>
				                                    </div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
				</fieldset>                
                <!-- <button type="submit" class="btn btn-primary stepy-finish">Submit <i class="icon-check position-right"></i></button>  -->      
            {{ form_end(form)}}            
        </div>
            </div>
            
        </div>
    </div>
        
        <hr>
        
        
        
{% endblock %}

{% block codejs %}
     
    <script>
        $(document).on("ready", function(){
            
            
            
            // Show form
    var form = $(".steps-validation").show();


    // Initialize wizard
    $(".steps-validation").steps({
        headerTag: "h6",
        bodyTag: "fieldset",
        transitionEffect: "fade",
        titleTemplate: '<span class="number">#index#</span> #title#',
        autoFocus: true,
        onStepChanging: function (event, currentIndex, newIndex) {

            // Allways allow previous action even if the current form is not valid!
            if (currentIndex > newIndex) {
                return true;
            }

            // Forbid next action on "Warning" step if the user is to young
            if (newIndex === 3 && Number($("#age-2").val()) < 18) {
                return false;
            }

            // Needed in some cases if the user went back (clean up)
            if (currentIndex < newIndex) {

                // To remove error styles
                form.find(".body:eq(" + newIndex + ") label.error").remove();
                form.find(".body:eq(" + newIndex + ") .error").removeClass("error");
            }

            form.validate().settings.ignore = ":disabled,:hidden";
            return form.valid();
        },

        onStepChanged: function (event, currentIndex, priorIndex) {

            // Used to skip the "Warning" step if the user is old enough.
            if (currentIndex === 2 && Number($("#age-2").val()) >= 18) {
                form.steps("next");
            }

            // Used to skip the "Warning" step if the user is old enough and wants to the previous step.
            if (currentIndex === 2 && priorIndex === 3) {
                form.steps("previous");
            }
        },

        onFinishing: function (event, currentIndex) {
            form.validate().settings.ignore = ":disabled";
            return form.valid();
        },

        onFinished: function (event, currentIndex) {
            alert("Submitted!");
        }
    });


    // Initialize validation
    $(".steps-validation").validate({
        ignore: 'input[type=hidden], .select2-search__field', // ignore hidden fields
        errorClass: 'validation-error-label',
        successClass: 'validation-valid-label',
        highlight: function(element, errorClass) {
            $(element).removeClass(errorClass);
        },
        unhighlight: function(element, errorClass) {
            $(element).removeClass(errorClass);
        },

        // Different components require proper error label placement
        errorPlacement: function(error, element) {

            // Styled checkboxes, radios, bootstrap switch
            if (element.parents('div').hasClass("checker") || element.parents('div').hasClass("choice") || element.parent().hasClass('bootstrap-switch-container') ) {
                if(element.parents('label').hasClass('checkbox-inline') || element.parents('label').hasClass('radio-inline')) {
                    error.appendTo( element.parent().parent().parent().parent() );
                }
                 else {
                    error.appendTo( element.parent().parent().parent().parent().parent() );
                }
            }

            // Unstyled checkboxes, radios
            else if (element.parents('div').hasClass('checkbox') || element.parents('div').hasClass('radio')) {
                error.appendTo( element.parent().parent().parent() );
            }

            // Input with icons and Select2
            else if (element.parents('div').hasClass('has-feedback') || element.hasClass('select2-hidden-accessible')) {
                error.appendTo( element.parent() );
            }

            // Inline checkboxes, radios
            else if (element.parents('label').hasClass('checkbox-inline') || element.parents('label').hasClass('radio-inline')) {
                error.appendTo( element.parent().parent() );
            }

            // Input group, styled file input
            else if (element.parent().hasClass('uploader') || element.parents().hasClass('input-group')) {
                error.appendTo( element.parent().parent() );
            }

            else {
                error.insertAfter(element);
            }
        },
        rules: {
            email: {
                email: true
            }
        }
    });
    
    $('.select').select2();
            
            /*
            // Initialize wizard
            
            // Override defaults
            $.fn.stepy.defaults.legend = false;
            $.fn.stepy.defaults.transition = 'fade';
            $.fn.stepy.defaults.duration = 150;
            $.fn.stepy.defaults.backLabel = '<i class="icon-arrow-left13 position-left"></i> Atras';
            $.fn.stepy.defaults.nextLabel = 'Siguiente <i class="icon-arrow-right14 position-right"></i>';
            
            $(".stepy-validation").stepy({
                validate: true,
                block: true,
                next: function(index) {
                    if (!$(".stepy-validation").validate(validate)) {
                        return false
                    }
                    
                }
            });
            
            // Initialize validation
            var validate = {
                ignore: 'input[type=hidden], .select2-search__field', // ignore hidden fields
                errorClass: 'validation-error-label',
                successClass: 'validation-valid-label',
                highlight: function(element, errorClass) {
                    $(element).removeClass(errorClass);
                },
                unhighlight: function(element, errorClass) {
                    $(element).removeClass(errorClass);
                },

                // Different components require proper error label placement
                errorPlacement: function(error, element) {

                    // Styled checkboxes, radios, bootstrap switch
                    if (element.parents('div').hasClass("checker") || element.parents('div').hasClass("choice") || element.parent().hasClass('bootstrap-switch-container') ) {
                        if(element.parents('label').hasClass('checkbox-inline') || element.parents('label').hasClass('radio-inline')) {
                            error.appendTo( element.parent().parent().parent().parent() );
                        }
                         else {
                            error.appendTo( element.parent().parent().parent().parent().parent() );
                        }
                    }

                    // Unstyled checkboxes, radios
                    else if (element.parents('div').hasClass('checkbox') || element.parents('div').hasClass('radio')) {
                        error.appendTo( element.parent().parent().parent() );
                    }

                    // Input with icons and Select2
                    else if (element.parents('div').hasClass('has-feedback') || element.hasClass('select2-hidden-accessible')) {
                        error.appendTo( element.parent() );
                    }

                    // Inline checkboxes, radios
                    else if (element.parents('label').hasClass('checkbox-inline') || element.parents('label').hasClass('radio-inline')) {
                        error.appendTo( element.parent().parent() );
                    }

                    // Input group, styled file input
                    else if (element.parent().hasClass('uploader') || element.parents().hasClass('input-group')) {
                        error.appendTo( element.parent().parent() );
                    }

                    else {
                        error.insertAfter(element);
                    }
                },
                rules: {
                    email: {
                        email: true
                    }
                }
            }
            
            // Apply "Back" and "Next" button styling
            $('.stepy-step').find('.button-next').addClass('btn btn-primary');
            $('.stepy-step').find('.button-back').addClass('btn btn-default');
            */
        });
    </script>
{% endblock %}    
