{% extends "::_admin_base.html.twig" %}
  
{% block body %}
    
    <h1>Edición de Municipio</h1>
    {% for flashMessage in app.session.flashbag.get('success') %}
        <div class="alert alert-dismissible alert-success"><span class="glyphicon glyphicon-ok-sign"></span> {{ flashMessage }}</div>
    {% endfor %}
    {% for flashMessage in app.session.flashbag.get('error') %}
        <div class="alert alert-dismissible alert-danger"><span class="glyphicon glyphicon-exclamation-sign"></span> {{ flashMessage }}</div>
    {% endfor %}
    
    <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-12">
            
            {#
            {{ form_start(edit_form) }}
            {{ form_widget(edit_form) }}
            <input type="submit" value="Edit" />
            {{ form_end(edit_form) }}
            #}
            
            {{ form_start(edit_form) }}

                <div class="form_error">{{ form_errors(edit_form)}}</div>
                <div class="form-group">

                    <div class="form_error">{{ form_errors(edit_form.nombreSysMunicipo)}}</div>
                    <div><label for="">Municipio</label></div>
                    {{ form_widget(edit_form.nombreSysMunicipo) }}
                </div>
                <div class="form-group">
                    <div class="form_error">{{ form_errors(edit_form.descripcionSysMunicipio)}}</div>
                    <div><label for="" class="">Descripción</label></div>
                    {{ form_widget(edit_form.descripcionSysMunicipio) }}
                </div>
                <div class="form-group">
                    <div class="form_error">{{ form_errors(edit_form.myExtraFieldCountry)}}</div>
                    <label for="" class=" control-label">Pais</label>
                    {{ form_widget(edit_form.myExtraFieldCountry) }}
                </div>
                <div class="form-group">
                    <div class="form_error">{{ form_errors(edit_form.sysDepartamentos)}}</div>
                    <label for="" class=" control-label">Departamento</label>
                    {{ form_widget(edit_form.sysDepartamentos) }}
                </div>

                <div class="form-group">
                    <div class="form_error">{{ form_errors(edit_form.estatusSysMunicipo)}}</div>
                    <div>Estatus</div>
                    <div class="checkbox">
                        <label>
                            {{ form_widget(edit_form.estatusSysMunicipo) }}
                            <span class="text"></span>
                        </label>
                    </div>   
                </div>

                <input type="submit" value="Editar" class="btn btn-info" />
            {{ form_end(edit_form) }}
            
            <hr>
                
            <ul class="btn-option-emr">
                <li>
                    <a href="{{ path('sysmunicipio_index') }}" class="btn btn-default"><i class="glyphicon glyphicon-th-list"></i> Regresar a la lista</a>
                </li>
                <li>
                    {{ form_start(delete_form) }}
                        <input type="submit" value="Eliminar" class="btn btn-danger">
                    {{ form_end(delete_form) }}
                </li>
                <li>
                    <a href="{{ path('sysmunicipio_new')}}" class="btn btn-inverse"><i class="fa fa-plus"></i> Nuevo </a>
                </li>

            </ul>    
        
        </div>
    </div>
{% endblock %}

{% block codejs %}
    <script>
        $(function(){
            getDepartment();
            $("#sys_municipio_myExtraFieldCountry").change(function(){
                getDepartment();
            });
            function getDepartment()
            {
                var id = $("#sys_municipio_myExtraFieldCountry").val();
                console.log(id);
                if( id == "" || id == undefined){
                    return false;
                }
                $("#emrloading").show();
                $.ajax({
                        url: "{{ path('sysdepartamentos_per_country')}}",
                        data: {
                             countryID: id,
                        },
                        error: function() {
                             alert("Ha ocurrido un error");
                             $("#request").empty();
                             $("#emrloading").hide();
                        },
                          //dataType: 'json',
                        success: function(data) {
                            $("#emrloading").hide();
                            $("#sys_municipio_sysDepartamentos").empty();
                            $.each(data.res, function(i,item){
                               var id = item.id;
                               var name = item.nombreSysDepartamento;
                               $('<option>').val(id).text(name).appendTo('#sys_municipio_sysDepartamentos');
                            });
                        },
                        type: 'POST'
                	});
            }
          });
    </script>
{% endblock %} 